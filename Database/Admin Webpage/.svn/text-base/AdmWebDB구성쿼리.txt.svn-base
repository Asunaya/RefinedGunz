CREATE TABLE MemberGrade(
 MGradeID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL )
GO

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (0, 'Admin')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (1, 'Chief GM')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (2, 'Chief Dev')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (3, 'GM')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (4, 'Developer')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (5, 'CS1')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (6, 'CS2')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (7, 'Marketer')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (8, 'External User')

INSERT INTO MemberGrade(MGradeID, Description)
VALUES (9, 'Blocked ID')
GO

-------------------------------------------------------------------------------

CREATE TABLE TeamPart(
 TPartID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL)
GO

INSERT INTO TeamPart(TPartID, Description)
VALUES (0, 'Undivided')

INSERT INTO TeamPart(TPartID, Description)
VALUES (1, 'Develop')

INSERT INTO TeamPart(TPartID, Description)
VALUES (2, 'Marketing')

INSERT INTO TeamPart(TPartID, Description)
VALUES (3, 'System')

INSERT INTO TeamPart(TPartID, Description)
VALUES (4, 'GM')

INSERT INTO TeamPart(TPartID, Description)
VALUES (5, 'CS')

INSERT INTO TeamPart(TPartID, Description)
VALUES (6, 'Design')

INSERT INTO TeamPart(TPartID, Description)
VALUES (7, 'Common')
GO

-------------------------------------------------------------------------------

CREATE TABLE UserGrade(
 UGradeID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL)
GO

INSERT INTO UserGrade( UGradeID, Description )
VALUES (0, 'General User' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (1, 'Fixed Amount User' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (2, 'Best Gamer' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (100, 'Marked Man' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (101, 'First Warning' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (102, 'Second Warning' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (103, 'Third Warning' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (104, 'Chatting Forbidden' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (105, 'Time Block' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (252, 'Event Master' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (253, 'Permanent Block' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (254, 'Developer' )

INSERT INTO UserGrade( UGradeID, Description )
VALUES (255, 'Manager' )
GO

-------------------------------------------------------------------------------

CREATE TABLE GMCategory(
 GMCategoryID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL)
GO

insert into GMCategory(GMCategoryID, Description) values (1,'Member')
insert into GMCategory(GMCategoryID, Description) values (2,'Server')
insert into GMCategory(GMCategoryID, Description) values (3,'Account Info')
insert into GMCategory(GMCategoryID, Description) values (4,'Character Info')
insert into GMCategory(GMCategoryID, Description) values (5,'CLAN')
insert into GMCategory(GMCategoryID, Description) values (6,'Report Treatment')
insert into GMCategory(GMCategoryID, Description) values (7,'Forbidden Word')
insert into GMCategory(GMCategoryID, Description) values (8,'Purchase')
insert into GMCategory(GMCategoryID, Description) values (9,'Refund/Exchange Request')
insert into GMCategory(GMCategoryID, Description) values (10,'User Statistic')
insert into GMCategory(GMCategoryID, Description) values (11,'Charging Fee Statistic')
insert into GMCategory(GMCategoryID, Description) values (12,'Event Statistic')
insert into GMCategory(GMCategoryID, Description) values (13,'Access LOG')
insert into GMCategory(GMCategoryID, Description) values (14,'Shop')
go

-------------------------------------------------------------------------------

CREATE TABLE ProcessStatus(
 PStatusID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL )
GO

insert into ProcessStatus(pstatusid, description) values (0,'Registration')
insert into ProcessStatus(pstatusid, description) values (1,'Refund Approval')
insert into ProcessStatus(pstatusid, description) values (2,'Refund Rejected')
insert into ProcessStatus(pstatusid, description) values (3,'Payment Approval')
insert into ProcessStatus(pstatusid, description) values (4,'Payment Rejected')
insert into ProcessStatus(pstatusid, description) values (5,'Exchange Approval')
insert into ProcessStatus(pstatusid, description) values (6,'Exchange Rejected')
insert into ProcessStatus(pstatusid, description) values (7,'Restoration Approval')
insert into ProcessStatus(pstatusid, description) values (8,'Restoration Rejected')
insert into ProcessStatus(pstatusid, description) values (9,'Manual Process')
insert into ProcessStatus(pstatusid, description) values (10,'Item Deleted')
insert into ProcessStatus(pstatusid, description) values (11,'Refunded')
insert into ProcessStatus(pstatusid, description) values (12,'Item Provided')
go

-------------------------------------------------------------------------------

CREATE TABLE ProcessingStatus(
 PngStatusID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL )
GO

insert into ProcessingStatus(pngstatusid, description) values (0,'Registration')
insert into ProcessingStatus(pngstatusid, description) values (1,'In Processing')
insert into ProcessingStatus(pngstatusid, description) values (2,'Impossible Processing')
insert into ProcessingStatus(pngstatusid, description) values (3,'Processing Completed')
insert into ProcessingStatus(pngstatusid, description) values (4,'Processing Reservation')
insert into ProcessingStatus(pngstatusid, description) values (5,'Processing Completed')
insert into ProcessingStatus(pngstatusid, description) values (6,'Impossible Processing')
insert into ProcessingStatus(pngstatusid, description) values (7,'In Processing')
insert into ProcessingStatus(pngstatusid, description) values (8,'Impossible Processing')
insert into ProcessingStatus(pngstatusid, description) values (9,'Processing Completed')
insert into ProcessingStatus(pngstatusid, description) values (10,'In Processing')
insert into ProcessingStatus(pngstatusid, description) values (11,'In Processing')
insert into ProcessingStatus(pngstatusid, description) values (12,'In Processing')
go

-------------------------------------------------------------------------------

CREATE TABLE CategoryType(
 CategoryTypeID int PRIMARY KEY
, Description varchar(30) NOT NULL )
GO

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (1, 'Refund' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (2, 'Exchange' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (3, 'Character Restoration' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (4, 'Check Needed' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (5, 'Proposal' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (6, 'Bug' )

INSERT INTO CategoryType( CategoryTypeID, Description )
VALUES (7, 'Others' )
GO

-------------------------------------------------------------------------------

CREATE TABLE AccessGrade(
 AGradeID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL )
GO

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (1, 'Member' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (2, 'Server' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (3, 'User' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (4, 'Report Treatment' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (5, 'Statistic' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (6, 'Forum' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (7, 'Chatting Report' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (9, 'Shop' )

INSERT INTO AccessGrade( AGradeID, Description )
VALUES (13, 'Access LOG' )
GO

-------------------------------------------------------------------------------

CREATE TABLE GradeType(
 GTypeID int PRIMARY KEY CLUSTERED
, Description varchar(30) NOT NULL )
GO

INSERT INTO GradeType( GTypeID, Description )
VALUES (1, 'Chatting' )

INSERT INTO GradeType( GTypeID, Description )
VALUES (2, 'Game' )

INSERT INTO GradeType( GTypeID, Description )
VALUES (3, 'Web' )

INSERT INTO GradeType( GTypeID, Description )
VALUES (4, 'Operation' )

INSERT INTO GradeType( GTypeID, Description )
VALUES (5, 'Restraint Release' )
GO

-------------------------------------------------------------------------------

CREATE TABLE [abuse_word] (
	[AbuseWord] [varchar] (32) NOT NULL ,
	[ReplaceWord] [varchar] (32) NULL ,
	[Checked] [bit] NULL ,
	 PRIMARY KEY  CLUSTERED 
	(
		[AbuseWord]
	)  ON [PRIMARY] 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_AbuseWord_AbuseWord
ON abuse_word(AbuseWord)

CREATE NONCLUSTERED INDEX IX_AbuseWord_Checked
ON abuse_word(Checked)
GO

-------------------------------------------------------------------------------

CREATE TABLE [Forum] (
	[seq] [int] IDENTITY(1, 1) PRIMARY KEY CLUSTERED,
	[id] [int] NULL ,
	[depth] [smallint] NOT NULL ,
	[subject] [varchar] (50) NOT NULL ,
	[gmid] [varchar] (25) NOT NULL ,
	[regdate] [smalldatetime] NULL ,
	[countread] [int] NULL ,
	[contents] [varchar] (1000) NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_Forum_id
ON Forum(id)

CREATE NONCLUSTERED INDEX IX_Forum_Subject
ON Forum(subject)

CREATE NONCLUSTERED INDEX IX_Forum_regdate
ON Forum(regdate)
GO

-------------------------------------------------------------------------------

CREATE TABLE [ForumComment] (
	[id] [int] IDENTITY (1, 1) NOT NULL ,
	[seq] [int] NOT NULL FOREIGN KEY REFERENCES Forum(seq) ON DELETE NO ACTION,
	[comment] [varchar] (2000) NULL ,
	[gmid] [varchar] (25) NULL ,
	[regdate] [smalldatetime] NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_ForumComment_seq
ON ForumComment(seq)

CREATE NONCLUSTERED INDEX IX_ForumComment_gmid
ON ForumComment(gmid)
GO

-------------------------------------------------------------------------------

CREATE TABLE [ForumFreeboard] (
	[seq] [int] IDENTITY (1, 1) PRIMARY KEY CLUSTERED ,
	[gmid] [varchar] (25) NOT NULL ,
	[subject] [varchar] (50) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL ,
	[readcount] [int] NOT NULL ,
	[content] [varchar](4000) NOT NULL ,
	[link1] [varchar] (255) NULL ,
	[link2] [varchar] (255) NULL ,
	[file1] [varchar] (255) NULL ,
	[file2] [varchar] (255) NULL ,
	[gr_id] [int] NULL ,
	[gr_depth] [smallint] NULL ,
	[gr_pos] [int] NULL ,
	[thread] [int] NULL
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_ForumFreeboard_Subject
ON ForumFreeboard(subject)

CREATE NONCLUSTERED INDEX IX_ForumFreeboard_thread
ON ForumFreeboard(thread)

CREATE NONCLUSTERED INDEX IX_ForumFreeboard_regdate
ON ForumFreeboard(regdate)
GO

-------------------------------------------------------------------------------

CREATE TABLE [ForumFreeboardComment] (
	[id] [int] IDENTITY (1, 1) NOT NULL ,
	[seq] [int] NOT NULL FOREIGN KEY REFERENCES ForumFreeboard(seq) ON DELETE NO ACTION,
	[comment] [varchar] (2000) NULL ,
	[gmid] [varchar] (25) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_ForumFreeboardComment_seq
ON ForumFreeboardComment(seq)
GO

-------------------------------------------------------------------------------

CREATE TABLE [ForumTeam] (
	[seq] [int] IDENTITY (1, 1) PRIMARY KEY CLUSTERED ,
	[gmid] [varchar] (25) NOT NULL ,
	[subject] [varchar] (50) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL ,
	[readcount] [int] NOT NULL ,
	[content] [varchar] (4000) NOT NULL ,
	[team] [tinyint] NOT NULL ,
	[link1] [varchar] (255) NULL ,
	[link2] [varchar] (255) NULL ,
	[file1] [varchar] (255) NULL ,
	[file2] [varchar] (255) NULL ,
	[gr_id] [int] NULL ,
	[gr_depth] [int] NULL ,
	[gr_pos] [int] NULL ,
	[thread] [int] NULL,
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_ForumTeam_subject
ON ForumTeam(subject)

CREATE NONCLUSTERED INDEX IX_ForumTeam_gr_id
ON ForumTeam(gr_id)

CREATE NONCLUSTERED INDEX IX_ForumTeam_gr_depth
ON ForumTeam(gr_depth)

CREATE NONCLUSTERED INDEX IX_ForumTeam_gr_pos
ON ForumTeam(gr_pos)

CREATE NONCLUSTERED INDEX IX_ForumTeam_thread
ON ForumTeam(thread)
GO

-------------------------------------------------------------------------------

CREATE TABLE [ForumTeamComment] (
	[id] [int] IDENTITY (1, 1) NOT NULL ,
	[seq] [int] NOT NULL FOREIGN KEY REFERENCES ForumTeam(seq) ON DELETE NO ACTION ,
	[comment] [varchar] (2000) NULL ,
	[gmid] [varchar] (25) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL 
) ON [PRIMARY]
GO


CREATE NONCLUSTERED INDEX IX_ForumTeamComment_seq
ON ForumTeamComment(seq)
GO

-------------------------------------------------------------------------------

CREATE TABLE [GMLog] (
	[seq] [int] IDENTITY PRIMARY KEY CLUSTERED  ,
	[gmid] [varchar] (25) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL ,
	[category] [smallint] NOT NULL ,
	[category_sub] [varchar] (30) NOT NULL ,
	[userid] [varchar] (25) NULL ,
	[gameid] [varchar] (25) NULL ,
	[content] [varchar] (100) NOT NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_GMLog_regdate
ON GMLog(regdate)

CREATE NONCLUSTERED INDEX IX_GMLog_gmid
ON GMLog(gmid)

CREATE NONCLUSTERED INDEX IX_GMLog_userid
ON GMLog(userid)

CREATE NONCLUSTERED INDEX IX_GMLog_gameid
ON GMLog(gameid)
GO

-------------------------------------------------------------------------------

CREATE TABLE [GMSuggest] (
	[seq] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY CLUSTERED,
	[subject] [varchar] (50) NOT NULL ,
	[gmid] [varchar] (25) NOT NULL ,
	[content] [varchar] (4000) NOT NULL ,
	[regdate] [smalldatetime] NOT NULL ,
	[category] [tinyint] NULL ,
	[userid] [varchar] (25) NULL ,
	[type] [tinyint] NULL ,
	[typedate] [smalldatetime] NULL ,
	[link1] [varchar] (255) NULL ,
	[link2] [varchar] (255) NULL ,
	[file1] [varchar] (255) NULL ,
	[file2] [varchar] (255) NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_GMSuggest_subject
ON GMSuggest(subject)

CREATE NONCLUSTERED INDEX IX_GMSuggest_userid
ON GMSuggest(userid)
GO

-------------------------------------------------------------------------------

CREATE TABLE [GMSuggestComment] (
	[id] [int] IDENTITY (1, 1) NOT NULL ,
	[seq] [int] NOT NULL FOREIGN KEY REFERENCES GMSuggest(seq) ON DELETE NO ACTION,
	[gmid] [varchar] (25) NOT NULL ,
	[comment] [varchar] (500) NOT NULL ,
	[regdate] [smalldatetime] NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_GMSuggestComment_seq
ON GMSuggestComment(seq)
GO

-------------------------------------------------------------------------------

CREATE TABLE [GMSuggestDataLog] (
	[ID] [int] IDENTITY (1, 1) NOT NULL ,
	[Seq] [int] NOT NULL ,
	[GMID] [varchar] (24) NOT NULL ,
	[UserID] [varchar] (24) NOT NULL ,
	[RegDate] [smalldatetime] NOT NULL ,
	[Status] [smallint] NULL ,
	CONSTRAINT [PK_GMSuggestDataLog] PRIMARY KEY  CLUSTERED 
	(
		[ID]
	)  ON [PRIMARY] 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_GMSuggestDataLog_Seq
ON GMSuggestDataLog(Seq)

CREATE NONCLUSTERED INDEX IX_GMSuggestDataLog_UserID
ON GMSuggestDataLog(UserID)

CREATE NONCLUSTERED INDEX IX_GMSuggestDataLog_RegDate
ON GMSuggestDataLog(RegDate)
GO

-------------------------------------------------------------------------------

CREATE TABLE [GMSuggestRecoverCharDataLog] (
	[ID] [int] IDENTITY (1, 1) NOT NULL ,
	[Seq] [int] NOT NULL ,
	[GMID] [varchar] (20) NOT NULL ,
	[UserID] [varchar] (24) NOT NULL ,
	[RecCharName] [varchar] (24) NULL ,
	[RegDate] [datetime] NOT NULL ,
	[Status] [smallint] NOT NULL ,
	CONSTRAINT [PK_GMSuggestRecoverCharDataLog] PRIMARY KEY  CLUSTERED 
	(
		[ID]
	)  ON [PRIMARY] 
) ON [PRIMARY]
GO


CREATE NONCLUSTERED INDEX IX_GMSuggestRecoverCharDataLog_Seq
ON GMSuggestRecoverCharDataLog(Seq)

CREATE NONCLUSTERED INDEX IX_GMSuggestRecoverCharDataLog_GMID
ON GMSuggestRecoverCharDataLog(GMID)

CREATE NONCLUSTERED INDEX IX_GMSuggestRecoverCharDataLog_UserID
ON GMSuggestRecoverCharDataLog(UserID)

CREATE NONCLUSTERED INDEX IX_GMSuggestRecoverCharDataLog_RegDate
ON GMSuggestRecoverCharDataLog(RegDate)
GO

-------------------------------------------------------------------------------

CREATE TABLE [MemberLoginLog] (
	[ID] [int] IDENTITY (1, 1) NOT NULL ,
	[SessionID] [varchar] (25) NOT NULL ,
	[GMID] [varchar] (25) NULL ,
	[ClientIP] [varchar] (15) NULL ,
	[LoginTime] [smalldatetime] NOT NULL ,
	CONSTRAINT [PK_MemberLoginLog] PRIMARY KEY  CLUSTERED 
	(
		[ID]
	)  ON [PRIMARY] 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_MemberLoginLog_SessionID
ON MemberLoginLog(SessionID)

CREATE NONCLUSTERED INDEX IX_MemberLoginLog_GMID
ON MemberLoginLog(GMID)

CREATE NONCLUSTERED INDEX IX_MemberLoginLog_LoginTime
ON MemberLoginLog(LoginTime)
GO

-------------------------------------------------------------------------------

CREATE TABLE [Members] (
	[GMID] [varchar] (20) NOT NULL PRIMARY KEY CLUSTERED,
	[Password] [char] (12) NOT NULL ,
	[Name] [varchar] (25) NOT NULL ,
	[Position] [int] NOT NULL FOREIGN KEY REFERENCES MemberGrade(MGradeID) ON DELETE NO ACTION,
	[Grade] [int] NOT NULL FOREIGN KEY REFERENCES MemberGrade(MGradeID) ON DELETE NO ACTION,
	[AccessIP] [char] (15) NULL ,
	[Exaccess] [varchar] (6) NULL ,
	[Port] [int] NULL ,
	[Description] [varchar] (500) NULL ,
	[ID] [int] IDENTITY NOT NULL ,
	[RegDate] [smalldatetime] NOT NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_Members_Password
ON Members(Password)

CREATE NONCLUSTERED INDEX IX_Members_Position
ON Members(Position)

CREATE NONCLUSTERED INDEX IX_Members_Grade
ON Members(Grade)
GO


-------------------------------------------------------------------------------

CREATE TABLE [OperationDetails] (
	[CodeNO] [int] NOT NULL PRIMARY KEY CLUSTERED ,
	[Category] [smallint] NOT NULL ,
	[Category_sub] [varchar] (40) NULL ,
	[Description] [varchar] (1000),
) ON [PRIMARY]
GO

INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1000, 1, 'Member')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1100, 1, 'See Member List')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1110, 1, 'Membership Registration/Alteration')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1120, 1, 'Setup Rights by Grade')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1200, 1, 'Password Alteration  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1300, 1, 'Verify Business Log  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (1400, 1, 'Forbidden Word See/Register  ')
INSERT INTO OperationDetails(CodeNo, Category, Category_Sub) VALUES (1500, 1, 'WebItem Management' )
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (2000, 2, 'Server  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (2100, 2, 'See Server Information  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (2110, 2, 'Server Open/Close  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3000, 3, 'User')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3100, 3, 'See Account Information')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3110, 3, 'UGrade Alteration')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3120, 3, 'Account Alteration')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3130, 3, 'See Character Delete Log  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3131, 3, 'Character Delete/Restoration  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3132, 3, 'Character Restoration Register  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3140, 3, 'CashItem Refund/Exchange Register  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3150, 3, 'CashItem Delete  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3160, 3, 'CashItem Add  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3200, 3, 'See Character Information  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3210, 3, 'Character Information Alteration  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3220, 3, 'BountyItem Delete  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3230, 3, 'BountyItem Add  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3300, 3, 'See Clan Information  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3310, 3, 'Clan Information Alteration  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3320, 3, 'Clan Delete  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3330, 3, 'Clan Making  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3400, 3, 'See CashItem Purchase Log  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3500, 3, 'See CashItem Use Log  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (3600, 3, 'BountyItem Purchase Log  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4000, 4, 'Treatment Record  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4100, 4, 'CashItem Refund Approval  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4200, 4, 'CashItem Exchange Approval  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4300, 4, 'CashItem Payment Approval  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4400, 4, 'CashItem Manual Process  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4500, 4, 'Character Restoration Approval  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4600, 4, 'Character Manual Process  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (4700, 4, 'Etc Report Manul Process  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (5000, 5, 'Statistic  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (5100, 5, 'User Statistic  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (5200, 5, 'Charging Fee Statistic  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (5300, 5, 'Event Statistic  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6000, 6, 'Forum  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6100, 6, 'Forum FAQ  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6110, 6, 'See Forum FAQ   ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6120, 6, 'Forum FAQ Register  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6130, 6, 'Forum FAQ Management  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6200, 6, 'Free Bulletin Board  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6210, 6, 'See Free Bulletin Board  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6220, 6, 'Free Bulletin Board Register  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6230, 6, 'Free Bulletin Board Management  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6300, 6, 'Communication by Team  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6310, 6, 'See Communication by Team  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6320, 6, 'Communication by Team Register  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (6330, 6, 'Communication by Team Management  ')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (7000, 7, 'Chatting Report')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (7100, 7, 'Report Record')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (7110, 7, 'See Report Record')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (7120, 7, 'Report Treatment')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9000, 9, 'Shop')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9100, 9, 'See ShopItem List')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9110, 9, 'ShopItem Add')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9120, 9, 'ShopItem Alteration')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9130, 9, 'ShopItem Delete')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9200, 9, 'See SetShopItem')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9210, 9, 'SetShopItem Add')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9220, 9, 'SetShopItem Alteration')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9230, 9, 'SetShopItem Delete')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9300, 9, 'See ShopItemLog')
INSERT INTO OperationDetails(CodeNO, Category, Category_sub) VALUES (9400, 9, 'NewShopItem Management')
go

-------------------------------------------------------------------------------

CREATE TABLE [OperationGrade] (
	[ID] [int] IDENTITY NOT NULL ,
	[OGID] [int] NOT NULL FOREIGN KEY REFERENCES MemberGrade(MGradeID) ON DELETE NO ACTION,
	[CodeNO] [int] NOT NULL FOREIGN KEY REFERENCES OperationDetails(CodeNO) ON DELETE NO ACTION
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_OperationGrade_CodeNO
ON OperationGrade(CodeNO)

CREATE NONCLUSTERED INDEX IX_OperationGrade_OGID
ON OperationGrade(OGID)
GO

/*
SELECT 'INSERT INTO OperationGrade(OGID, CodeNO) VALUES (' +
 CAST(OGID AS varchar(128)) + ', ' + CAST(CodeNO AS varchar(128)) + ')'
FROM OperationGrade(NOLOCK)
ORDER BY id
*/
go


INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 1400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 2000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 2100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 2110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3131)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3132)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3140)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3150)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3160)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3230)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3330)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3500)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 3600)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4500)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4600)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 4700)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 5000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 5100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 5200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 5300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6230)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 6330)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3160)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3132)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3230)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 2000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 2100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3150)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3330)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3500)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3600)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 4000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 4500)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 4600)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 4700)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 6320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 6110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 3000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 3100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (3, 3400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 1200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 2110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 1400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 2000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 2100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 2110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3131)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3150)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3160)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3230)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3330)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3500)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 3600)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6230)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6310)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6320)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (8, 6330)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 3131)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 7000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 7100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 7110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (0, 7120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9000)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9100)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9200)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9300)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9400)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9110)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9120)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9130)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9210)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9220)
INSERT INTO OperationGrade(OGID, CodeNO) VALUES (1, 9230)
go


-------------------------------------------------------------------------------

CREATE TABLE [UGradeFactor] (
	[Type] [int] NOT NULL PRIMARY KEY CLUSTERED,
	[TypeName] [varchar] (35) NOT NULL 
) ON [PRIMARY]
GO

INSERT INTO UGradeFactor(Type, TypeName) VALUES (101, 'Abuse')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (102, 'Abuse on Parents')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (103, 'Indecent Chatting')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (104, 'Slander')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (105, 'Imposture')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (106, 'Papering Activity')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (107, 'Misrepresentation')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (201, 'Use of Bug')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (202, 'Use of Illegal Program')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (203, 'Abuser')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (204, 'Hacking')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (205, 'Fraud')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (301, 'Papering')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (302, 'Fraud')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (303, 'Advertisement of Administer ID')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (304, 'Indecent Post')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (305, 'Hacking')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (306, 'Abuse')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (401, 'Etc')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (402, 'Event')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (403, 'Test')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (404, 'Partnership')
INSERT INTO UGradeFactor(Type, TypeName) VALUES (501, 'Restraint Release')
go

-------------------------------------------------------------------------------

CREATE TABLE [UGradeLog] (
	[ID] [int] IDENTITY NOT NULL PRIMARY KEY CLUSTERED,
	[UserID] [varchar] (25) NOT NULL ,
	[Date] [datetime] NOT NULL ,
	[UGradeID] [int] NOT NULL ,
	[Duaration] [smallint] NULL ,
	[Type] [smallint] NOT NULL ,
	[Link] [varchar] (255) NULL 
) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX IX_UGradeLog_UserID
ON UGradeLog( UserID )
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebAddForumFreeboardReadCount 
 @Seq	int
AS
 SET NOCOUNT ON
 DECLARE @Count int

 SELECT @Count = max(readcount) + 1 FROM ForumFreeboard(NOLOCK) 
 WHERE seq = @Seq
 IF @Count IS NULL RETURN

 UPDATE ForumFreeboard SET readcount = @Count WHERE seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebAddForumReadCount 
 @Seq	int
AS
 SET NOCOUNT ON
 DECLARE @Count int

 SELECT @Count = max(countread) + 1 FROM forum(NOLOCK) 
 WHERE seq = @Seq
 IF @Count IS NULL RETURN

 UPDATE forum SET countread = @Count WHERE seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebAddForumTeamReadCount 
 @Seq	int
AS
 SET NOCOUNT ON
 DECLARE @Count int

 SELECT @Count = max(readcount) + 1 FROM ForumTeam(NOLOCK)
 WHERE seq = @Seq
 IF @Count IS NULL RETURN

 UPDATE ForumTeam SET readcount = @Count WHERE seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebChangeAbuseWord
 @AbuseWord varchar( 32 )
, @NewAbuseWord varchar( 32 )
AS
	SET NOCOUNT ON

	IF NOT EXISTS (SELECT AbuseWord FROM abuse_word(NOLOCK) WHERE AbuseWord = @AbuseWord) BEGIN
		SELECT 0 AS Ret
		RETURN
	END

	UPDATE abuse_word SET AbuseWord = @NewAbuseWord WHERE AbuseWord = @AbuseWord
	IF 0 = @@ROWCOUNT BEGIN
		SELECT 0 AS Ret
		RETURN
	END
	
	SELECT 1 AS Ret

GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteAbuseWord
 @AbuseWord varchar( 32 )
AS
 SET NOCOUNT ON
 DELETE abuse_word WHERE AbuseWord = @AbuseWord
 IF (0 <> @@ERROR) OR (0 = @@ROWCOUNT) BEGIN
  SELECT 0 AS Ret
  RETURN
 END

 SELECT 1 AS Ret
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForum
 @seq int
AS
 SET NOCOUNT ON
 DELETE Forum WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForumComment
 @ID int
AS
SET NOCOUNT ON
DELETE ForumComment WHERE id = @ID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForumFreeboard
 @seq int
AS
 SET NOCOUNT ON
 DELETE ForumFreeboard  WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForumFreeboardComment
 @ID int
AS
 DELETE ForumFreeboardComment WHERE id = @ID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForumTeam
 @seq int
AS
 SET NOCOUNT ON
 DELETE ForumTeam  WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteForumTeamComment
 @ID int
AS
 SET NOCOUNT ON
 DELETE ForumTeamComment WHERE id = @ID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteGMSuggest
 @seq int
AS
 SET NOCOUNT ON
 DELETE gmsuggest WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteGMSuggestComment
 @ID int
AS
 SET NOCOUNT ON
 DELETE gmsuggestcomment WHERE id = @ID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteGMSuggestDataLog
 @seq int
AS
 SET NOCOUNT ON
 DELETE GMSuggestDataLog WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteGMSuggestRecoverCharDataLog
 @seq int
AS
 SET NOCOUNT ON
 DELETE GMSuggestRecoverCharDataLog WHERE seq = @seq
GO
-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteMemberLoginLog
 @SessionID varchar(25)
AS
 SET NOCOUNT ON
 UPDATE MemberLoginLog SET GMID = NULL , ClientIP = NULL WHERE SessionID = @SessionID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteMembers
 @GMID varchar(20)
AS
 SET NOCOUNT ON
 DELETE Members  WHERE gmid = @GMID
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteOperationGrade
 @OGID tinyint,
 @CodeNO int
AS
 SET NOCOUNT ON
 DELETE OperationGrade 
 WHERE ogid = @OGID and codeno = @CodeNO
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteUGradeLog
 @id int
AS
 SET NOCOUNT ON
 DELETE UGradeLog WHERE id = @id
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebFindAbuseWord
	@AbuseWord varchar( 32 )
AS
 SET NOCOUNT ON

 SELECT AbuseWord 
 FROM abuse_word(NOLOCK) 
 WHERE AbuseWord LIKE '%' + @AbuseWord + '%'
 ORDER BY AbuseWord	
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebGetAbuseWordList
AS
 SET NOCOUNT ON

 SELECT AbuseWord FROM abuse_word(NOLOCK) ORDER BY AbuseWord
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertAbuseWord
 @NewAbuseWord varchar( 32 )
AS
 IF EXISTS (SELECT AbuseWord FROM abuse_word(NOLOCK) WHERE AbuseWord = @NewAbuseWord) BEGIN
  SELECT 0 AS Ret
  RETURN
 END

 INSERT INTO abuse_word( AbuseWord, Checked ) VALUES (@NewAbuseWord, 0)
 IF 0 <> @@ERROR BEGIN
  SELECT 0 AS Ret
  RETURN
 END

 SELECT 1 AS Ret
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertForum  
 @depth int,  
 @subject varchar(50),  
 @contents varchar(1000),  
 @gmid varchar(25)  
AS  
 SET NOCOUNT ON  
  
 DECLARE @id int  
 SELECT  TOP 1 @id = id + 1 FROM Forum(NOLOCK) ORDER BY id DESC  
 IF @id IS NULL 
  SET @id = 1
  
 INSERT INTO Forum ( id, depth, subject, contents, gmid, countread, regdate)  
 VALUES( @id, @depth, @subject, @contents, @gmid, 0, getdate())  
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertForumComment
 @seq int,
 @gmid varchar(25),
 @comment varchar(500)
AS
 SET NOCOUNT ON
 INSERT INTO forumcomment (seq,gmid, comment,regdate)
 VALUES(@seq,  @gmid, @comment,getdate())
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertForumFreeboard]
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	text,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
 SET NOCOUNT ON
 DECLARE @NewThread int

 SELECT TOP 1 @NewThread = thread + 1000 
 FROM ForumFreeBoard(NOLOCK)ORDER BY thread DESC
 IF @NewThread IS NULL
  SET @NewThread = 1000

 INSERT INTO ForumFreeboard 
	( GMID, Subject, Content,  Regdate, ReadCount, Link1, Link2, File1, File2,gr_id,gr_depth,gr_pos,thread)
 VALUES
	(@GMID, @Subject, @Content,  GetDate(), 0, @Link1, @Link2,@File1, @File2,0,0,0,@NewThread)

 UPDATE ForumFreeBoard set gr_id = seq where gr_id = 0
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertForumFreeboardComment
	@seq int,
	@gmid varchar(25),
	@comment varchar(2000)
	
AS
SET NOCOUNT ON
INSERT INTO forumfreeboardcomment (seq,gmid, comment,regdate)
VALUES(@seq,  @gmid, @comment,getdate())
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertForumTeam]
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	text,
	@Team		tinyint,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
 SET NOCOUNT ON
 DECLARE @NewThread int
 
 SELECT TOP 1 @NewThread = thread + 1000 
 FROM ForumTeam(NOLOCK) ORDER BY thread DESC
 IF @NewThread IS NULL
  SET @NewThread = 1000

 INSERT INTO ForumTeam
	( GMID, Subject, Content,  Regdate, Team,  ReadCount, Link1, Link2, File1, File2,gr_id,gr_depth,gr_pos,thread)
 VALUES
	(@GMID, @Subject, @Content, GetDate(), @Team, 0, @Link1, @Link2,@File1, @File2,0,0,0,@NewThread)

 UPDATE ForumTeam SET gr_id = seq WHERE gr_id = 0
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertForumTeamComment
	@seq int,
	@gmid varchar(25),
	@comment varchar(2000),
	@Ret int OUTPUT
AS
 SET NOCOUNT ON
 INSERT INTO ForumTeamComment (seq,gmid, comment,regdate)
 VALUES(@seq,  @gmid, @comment,getdate())
 IF (0 <> @@ERROR) OR (0 = @@ROWCOUNT) BEGIN
  SET @Ret = 0
  RETURN @Ret
 END

 SET @Ret = 1
 RETURN @Ret
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertGMLog
	@gmid 		varchar(25),
	@category 	smallint,
	@category_sub 	varchar(30),
	@userid		 varchar(25),
	@gameid	 varchar(25),
	@content	 varchar(100)
AS
 SET NOCOUNT ON
 INSERT INTO GMLog ( gmid, regdate,  category, category_sub, userid, gameid, content)
 VALUES(@gmid, GETDATE(), @category, @category_sub, @userid, @gameid, @content)
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertGMSuggest]
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	varchar(4000),
	@Category	tinyint,
	@Type		tinyint,	
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255),
	@UserID	varchar(20),
	@Status	smallint
AS
 SET NOCOUNT ON 

 BEGIN TRAN
 INSERT INTO GMSuggest 
 ( GMID, Subject, Content, Category, Regdate,Type,  Link1, Link2, File1, File2, UserID)
 VALUES
 (@GMID, @Subject, @Content, @Category, Getdate(), @Type,  @Link1, @Link2,@File1, @File2, @UserID)
 IF 0 <> @@ERROR BEGIN
  ROLLBACK TRAN
  RETURN 0
 END

 INSERT INTO GMSuggestDataLog( seq, GMID, UserID,  Regdate, Status)
 VALUES ( @@IDENTITY, @GMID, @UserID, Getdate(), @Status)
 IF 0 <> @@ERROR BEGIN 
  ROLLBACK TRAN
  RETURN 0
 END

 COMMIT TRAN
 RETURN 1
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertGMSuggestComment
	@seq int,
	@gmid varchar(25),
	@comment varchar(500)
AS
 SET NOCOUNT ON
 INSERT INTO gmsuggestcomment ( seq,gmid, comment,regdate)
 VALUES( @seq,  @gmid, @comment,getdate())
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertGMSuggestDataLog]
	@Seq		int,
	@GMID		varchar(20),
	@UserID	varchar(20),
	@Status	smallint
AS
 SET NOCOUNT ON
 BEGIN TRAN
 INSERT GMSuggestDataLog (SEQ, GMID, UserID, RegDate, Status) 
 VALUES (@Seq, @GMID, @UserID, GetDate(), @Status)
 IF 0 <> @@ERROR BEGIN 
  ROLLBACK TRAN
  RETURN 0
 END
	
 UPDATE GMSuggest SET type =  '9' , typedate = GetDate() WHERE Seq = @Seq  /* '9' = 수동처리 */
 IF 0 = @@ROWCOUNT BEGIN 
  ROLLBACK TRAN
  RETURN 0
 END

 COMMIT TRAN
 RETURN 1
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertGMSuggestRecoverChar]
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	varchar(4000),
	@Category	tinyint,
	@Type		tinyint,	
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255),
	@UserID	varchar(24),
	@RecCharName varchar(24),
	@Status	smallint
AS
 SET NOCOUNT ON
 BEGIN TRAN

 INSERT INTO GMSuggest 
 ( GMID, Subject, Content, Category, Regdate,Type,  Link1, Link2, File1, File2, UserID)
 VALUES
 (@GMID, @Subject, @Content, @Category, Getdate(), @Type,  @Link1, @Link2,@File1, @File2, @UserID)
 IF 0 <> @@ERROR BEGIN
  ROLLBACK TRAN
  RETURN 0
 END
	
 INSERT INTO GMSuggestRecoverCharDataLog( Seq, GMID, UserID, RecCharName,  Regdate, Status)
 VALUES ( @@IDENTITY, @GMID, @UserID, @RecCharName, Getdate(), @Status)
 IF 0 <> @@ERROR BEGIN
  ROLLBACK TRAN
  RETURN 0
 END

 COMMIT TRAN
 RETURN 1
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertGMSuggestRecoverCharDataLog]
	@Seq		int,
	@GMID		varchar(24),
	@UserID	varchar(24),
	@RecCharName varchar(24),
	@Status	smallint
AS
 SET NOCOUNT ON
 BEGIN TRAN
 INSERT GMSuggestRecoverCharDataLog (SEQ, GMID, UserID, RecCharName, RegDate, Status) 
 VALUES (@Seq, @GMID, @UserID, @RecCharName, GetDate(), @Status)
 IF 0 <> @@ERROR BEGIN 
  ROLLBACK TRAN
  RETURN 0
 END
 UPDATE GMSuggest SET type =  @Status , typedate = GetDate() WHERE Seq = @Seq 
 IF 0 = @@ROWCOUNT BEGIN 
  ROLLBACK TRAN
  RETURN 0
 END

 COMMIT TRAN
 RETURN 1
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertMemberLoginLog
	@SessionID varchar(25),
    	@GMID	varchar(24),
	@ClientIP varchar(15)
AS
 SET NOCOUNT ON
 INSERT INTO MemberLoginLog (SessionID, GMID, ClientIP, LoginTime)
 VALUES(@SessionID, @GMID, @ClientIP, GetDate())
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebInsertMembers] 
	@GMID		varchar(20),
	@Password	varchar(12),
	@Name		varchar(25),
	@Position	smallint,
	@Grade	tinyint,
	@AccessIP	varchar(128),
	@Exaccess	varchar(6),
	@Description	varchar(300)

AS
 SET NOCOUNT ON
 INSERT INTO Members 
  (GMID, Password, Name, Position, Grade, AccessIP, Exaccess, Description, RegDate)
 Values
  (@GMID, @Password, @Name, @Position, @Grade, @AccessIP, @Exaccess, @Description, GetDate())
GO

-------------------------------------------------------------------------------

CREATE PROC [spAdmWebInsertOperationGrade] 
 @OGID tinyint
, @CodeNO int
AS
 SET NOCOUNT ON
 DECLARE @ID int

 INSERT INTO OperationGrade(OGID, CodeNO)
 VALUES (@OGID, @CodeNO)
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertUGradeLog
	@userid		varchar(25),
	@ugradeid 	smallint,
	@duaration 	smallint,
	@type		smallint,
	@link	 	varchar(255)
AS
 SET NOCOUNT ON
 INSERT INTO UGradeLog (userid, date,  ugradeid, duaration, type, link)
 VALUES(@userid, GETDATE(), @ugradeid, @duaration, @type, @link)
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebReplyForum
	@seq	int,
	@depth int,
	@subject varchar(50),
	@contents varchar(1000),
	@gmid varchar(25)
AS
 SET NOCOUNT ON
 DECLARE @id int

 SELECT @id = id FROM forum where seq = @seq

 INSERT INTO Forum ( id, depth, subject, contents, gmid, regdate , countread)
 VALUES( @id, @depth, @subject, @contents, @gmid, getdate(), 0)
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebReplyForumFreeboard]
	@Seq		int,
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	text,
	@gr_id		int,
	@gr_depth	int,
	@gr_pos	int,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
SET NOCOUNT ON
DECLARE @ParentThread       int
DECLARE @PrevThread          int

SELECT @ParentThread = Thread, @PrevThread = Thread - 1000
FROM ForumFreeboard(NOLOCK) 
WHERE Seq = @Seq AND gr_id = @gr_id AND gr_depth = 0

BEGIN TRAN
UPDATE ForumFreeBoard 
    SET thread = thread - 1
    Where thread < @ParentThread and thread > @PrevThread

UPDATE ForumFreeboard SET gr_pos =gr_pos+1
WHERE gr_id = @gr_id and gr_pos = @gr_pos
IF (0 = @@ROWCOUNT)
    BEGIN
        ROLLBACK TRAN
        RETURN
    END

SET @gr_depth = @gr_depth+1;
SET @gr_pos = @gr_pos + 1;

INSERT INTO ForumFreeboard 
	( GMID, Subject, Content,  Regdate, ReadCount,  Link1, Link2, File1, File2, gr_id, gr_depth, gr_pos, thread)
VALUES
	(@GMID, @Subject, @Content,  GetDate(), 0, @Link1, @Link2,@File1, @File2, @gr_id, @gr_depth, @gr_pos, @ParentThread-1)
IF (@@ERROR <> 0)
    BEGIN
        ROLLBACK TRAN
        RETURN
    END
COMMIT TRAN
GO


-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebReplyForumTeam]
	@Seq		int,
	@GMID		varchar(25),
	@Subject	varchar(50),
	@Content	text,
	@Team		tinyint,
	@gr_id		int,
	@gr_depth	int,
	@gr_pos	int,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
 SET NOCOUNT ON
 DECLARE @ParentThread       int
 DECLARE @PrevThread          int

 SELECT @ParentThread = Thread, @PrevThread = Thread - 1000
 FROM ForumTeam(NOLOCK) 
 WHERE Seq = @Seq AND gr_id = @gr_id AND gr_depth = 0

 BEGIN TRAN
 UPDATE ForumTeam
 SET thread = thread - 1
 Where thread < @ParentThread and thread > @PrevThread

 UPDATE ForumTeam SET gr_pos =gr_pos+1
 WHERE gr_id = @gr_id and gr_pos = @gr_pos
 IF (0 = @@ROWCOUNT)  BEGIN
  ROLLBACK TRAN
  RETURN
 END

 SET @gr_depth = @gr_depth+1;
 SET @gr_pos = @gr_pos + 1;

 INSERT INTO ForumTeam
	( GMID, Subject, Content,  Regdate, Team, ReadCount, Link1, Link2, File1, File2, gr_id, gr_depth, gr_pos,thread)
 VALUES
	(@GMID, @Subject, @Content,  GetDate(), @Team, 0, @Link1, @Link2,@File1, @File2, @gr_id, @gr_depth, @gr_pos, @ParentThread-1)
 IF 0 <> @@ERROR BEGIN
  ROLLBACK TRAN
  RETURN
 END

 COMMIT TRAN
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebUpdateForum
	@seq	int,
	@subject varchar(50),
	@contents varchar(1000)	
AS
 SET NOCOUNT ON
 Update forum SET subject = @subject, contents = @contents
 WHERE seq = @seq
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebUpdateForumFreeboard]
	@Seq		int,
	@Subject	varchar(50),
	@Content	text,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
SET NOCOUNT ON
UPDATE ForumFreeboard
SET  Subject= @Subject, Content=@Content,
 Link1=@Link1, Link2=@Link2, File1=@File1, File2= @File2
WHERE Seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebUpdateForumTeam]
	@Seq		int,
	@Subject	varchar(50),
	@Content	text,
	@Team		tinyint,
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
 SET NOCOUNT ON
 UPDATE ForumTeam
 SET Subject= @Subject, Content=@Content, Team = @Team,
  Link1=@Link1, Link2=@Link2, File1=@File1, File2= @File2
 WHERE Seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebUpdateGMPassword] 
	@GMID 	varchar(25),
	@NewPwd	varchar(15),
	@OldPwd	varchar(15)
AS
 SET NOCOUNT ON
 UPDATE Members SET password = @NewPwd
 WHERE gmid = @GMID and password = @OldPwd
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebUpdateGMSuggest]
	@Seq		int,
	@Subject	varchar(50),
	@Content	varchar(4000),
	@Link1		varchar(255),
	@Link2		varchar(255),
	@File1		varchar(255),
	@File2		varchar(255)
AS
 SET NOCOUNT ON
 UPDATE GMSuggest 
 SET Subject= @Subject, Content=@Content,
  Link1=@Link1, Link2=@Link2, File1=@File1, File2= @File2
 WHERE Seq = @Seq
GO

-------------------------------------------------------------------------------

CREATE PROC spAdmWebUpdateMemberLoginLog
	@SessionID varchar(25),
	@GMID	 varchar(24),
	@ClientIP varchar(15)
AS
 SET NOCOUNT ON
 UPDATE MemberLoginLog SET GMID = @GMID , ClientIP = @ClientIP WHERE SessionID = @SessionID
GO

-------------------------------------------------------------------------------

CREATE   PROC [spAdmWebUpdateMembers] 
	@GMID	varchar(20),
	@Password	varchar(12),
	@Name		varchar(25),
	@Position	smallint,
	@Grade	tinyint,
	@AccessIP	varchar(128),
	@Exaccess	varchar(6),
	@Description	varchar(300)

AS
 SET NOCOUNT ON
 UPDATE Members SET
  Password = @Password, Name=@Name, Position=@Position, 
  Grade=@Grade, AccessIP=@AccessIP, Exaccess=@Exaccess, Description=@Description
 WHERE GMID = @GMID
GO

-------------------------------------------------------------------------------

CREATE TABLE Item(
 ItemID int PRIMARY KEY CLUSTERED
, Name varchar(256)
, Slot tinyint
, IsCashItem tinyint 
, IsAdmWeb tinyint )
GO

CREATE NONCLUSTERED INDEX IX_Item_Name
ON Item( Name )
GO

/*
SELECT 'INSERT INTO Item(ItemID, Name) VALUES(' 
 + CAST(ItemID AS varchar(128)) + ', ' + '''' + Name + '''' + ')'
FROM Item(NOLOCK)
ORDER BY ItemID

SELECT 'UPDATE Item SET Slot = ' + CAST(Slot AS varchar(128)) +
 ' WHERE ItemID = ' + CAST(ItemID AS varchar(128))
FROM Item(NOLOCK)
WHERE Slot IS NOT NULL

SELECT 'UPDATE Item SET IsCashItem = ' + CAST(IsCashItem AS varchar(128)) +
 ' WHERE ItemID = ' + CAST(ItemID AS varchar(128))
FROM Item(NOLOCK)
WHERE IsCashItem IS NOT NULL
*/
go

-------------------------------------------------------------------------------

CREATE TABLE ItemSlotType(
 SlotType int PRIMARY KEY CLUSTERED
, Description varchar(24)
, Category varchar(24) )
GO

/*
SELECT 'INSERT INTO ItemSlotType(SlotType, Description, Category) VALUES (' +
 CAST(SlotType AS varchar(128)) + ', ' + '''' + Description + '''' + ', ' +
 '''' + Category + '''' + ')'
FROM ItemSlotType(NOLOCK)
ORDER BY SlotType
*/
go

insert into itemslottype(slottype, description, category) values (0,'No restriction','No Restriction')
insert into itemslottype(slottype, description, category) values (1,'Melee','Weapon')
insert into itemslottype(slottype, description, category) values (2,'Range','Weapon')
insert into itemslottype(slottype, description, category) values (3,'Item','Special item')
insert into itemslottype(slottype, description, category) values (4,'Head','Defence')
insert into itemslottype(slottype, description, category) values (5,'Chest','Defence')
insert into itemslottype(slottype, description, category) values (6,'Hands','Defence')
insert into itemslottype(slottype, description, category) values (7,'Legs','Defence')
insert into itemslottype(slottype, description, category) values (8,'Feet','Defence')
insert into itemslottype(slottype, description, category) values (9,'Finger','Special item')
insert into itemslottype(slottype, description, category) values (10,'SetItem','SetItem')
go

------------------------------------------------------------------------------

CREATE TABLE CashSetShop(
 CSSID int PRIMARY KEY CLUSTERED
, Name varchar(256)
, IsAdmWeb tinyint )
go

CREATE NONCLUSTERED INDEX IX_CashSetShop_Name
ON CashSetShop(Name)
GO

SELECT 'INSERT INTO CashSetShop(CSSID, Name) VALUES(' 
 + CAST(CSSID AS varchar(128)) + ', ' + '''' + Name + '''' + ')'
FROM CashSetShop(NOLOCK)
ORDER BY CSSID
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebUpdateWebItem
 @ItemID int
, @IsAdmWeb tinyint
, @Ret int OUTPUT
AS
 UPDATE Item SET IsAdmWeb = @IsAdmWeb WHERE ItemID = @ItemID
 IF 0 = @@ROWCOUNT BEGIN
  SET @Ret = 0
  RETURN @Ret
 END
 SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebUpdateWebCashSetShop
 @CSSID int
, @IsAdmWeb tinyint
, @Ret int OUTPUT
AS
 UPDATE CashSetShop SET IsAdmWeb = @IsAdmWeb WHERE CSSID = @CSSID
 IF 0 = @@ROWCOUNT BEGIN
  SET @Ret = 0
  RETURN @Ret
 END
 SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertWebItem
 @ItemID int
, @Name varchar(256)
, @Slot tinyint
, @IsCashItem tinyint
, @IsAdmWeb tinyint
, @Ret int OUTPUT
AS
 SET NOCOUNT ON
 INSERT INTO Item(ItemID, Name, Slot, IsCashItem, isAdmWeb)
 VALUES (@ItemID, @Name, @Slot, @IsCashItem, @IsAdmWeb)
 IF 0 <> @@ERROR SET @Ret = 0
 ELSE SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebInsertWebCashSetShop 
 @CSSID int
, @Name varchar(256)
, @IsAdmWeb tinyint
, @Ret int OUTPUT
AS 
 SET NOCOUNT ON
 INSERT INTO CashSetShop(CSSID, Name, IsAdmWeb)
 VALUES (@CSSID, @Name, @IsAdmWeb)
 IF 0 <> @@ERROR SET @Ret = 0
 ELSE SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebGetItemList
AS
 SET NOCOUNT ON
 SELECT ItemID, Name, Slot, IsCashItem
 FROM Item(NOLOCK)
 ORDER BY ItemID
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebGetCashSetShopList
AS
 SET NOCOUNT ON
 SELECT CSSID, Name
 FROM CashSetShop(NOLOCK)
 ORDER BY CSSID
GO
------------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteWebItem 
 @ItemID int
, @Ret int OUTPUT
AS
 SET NOCOUNT ON
 DELETE Item WHERE ItemID = @ItemID
 IF 0 <> @@ERROR SET @Ret = 0
 ELSE SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

CREATE PROC spAdmWebDeleteWebCashSetShop 
 @CSSID int
, @Ret int OUTPUT
AS
 SET NOCOUNT ON
 DELETE CashSetShop WHERE CSSID = @CSSID
 IF 0 <> @@ERROR SET @Ret = 0
 ELSE SET @Ret = 1
 RETURN @Ret
GO

------------------------------------------------------------------------------------

create table ChatReportComment(
 ID int IDENTITY
, No int
, GMID varchar(25)
, Comment varchar(1000)
, RegDate smalldatetime)
go

------------------------------------------------------------------------------------



CREATE PROC spAdmWebInsertWebItem  
 @ItemID int  
, @Name varchar(256)  
, @Slot tinyint  
, @IsCashItem tinyint  
, @IsAdmWeb tinyint  
, @Ret int OUTPUT  
AS  
 SET NOCOUNT ON  
 INSERT INTO Item(ItemID, Name, Slot, IsCashItem, isAdmWeb)  
 VALUES (@ItemID, @Name, @Slot, @IsCashItem, @IsAdmWeb)  
 IF 0 <> @@ERROR SET @Ret = 0  
 ELSE SET @Ret = 1  
 RETURN @Ret  
GO

-----------------------------------------------------------------------------------

-- spWebInsertAccount 프로시져 수정

 CREATE    PROC [spWebInsertAccount]   
 @UserID varchar(20)  
, @Password varchar(20)  
, @Cert tinyint  
, @Name varchar(30)
, @Question smallint
, @Answer varchar(30)
, @Status char(1)
, @Age smallint  
, @Country char(3)  
, @Sex tinyint  
, @Email varchar(50)=NULL  
, @Ret int OutPut  
AS  
 SET NOCOUNT ON  
 DECLARE @AIDIdent int  
  
 BEGIN TRAN  
 INSERT INTO Account (UserID, Cert, Name, Age, Sex, UGradeID, PGradeID, RegDate, Email, Question, Answer, Status, Country)  
 VALUES (@UserID, @Cert, @Name, @Age, @Sex, 0, 0, GETDATE(), @Email, @Question, @Answer, @Status, @Country)  
 IF @@ERROR <> 0 BEGIN  
  ROLLBACK TRAN  
  SET @Ret = 0  
  RETURN @Ret   
 END  
  
 SET @AIDIdent = @@IDENTITY  
 INSERT INTO login(UserID, AID, Password)  
 VALUES (@UserID, @AIDIdent, @Password)  
 IF @@ERROR <> 0 BEGIN  
  ROLLBACK TRAN  
  SET @Ret = 0  
  RETURN @Ret   
 END  
 COMMIT TRAN  
  
 SET @Ret = 1  
 RETURN @Ret  

GO


----------------------------------------------------------------------------------------------
-- spWebUpdateAccount 프로시져 수정

 CREATE    PROC [spWebUpdateAccount]     
  @UserID varchar(20)    
, @Password varchar(20)=NULL    
, @Cert tinyint    
, @Name  varchar(30)
, @Question smallint
, @Answer varchar(30)
, @Status char(1)  
, @Age smallint    
, @Country char(3)    
, @Sex tinyint    
, @Email varchar(50)=NULL    
, @Ret int OutPut    
AS    
 SET NOCOUNT ON
 BEGIN TRAN    
 IF (@Question = 0) BEGIN
  UPDATE Account SET  Cert = @Cert, Name = @Name, Age = @Age, Sex = @Sex, Email = @Email,     
   Country = @Country    
  WHERE UserID = @UserID    
  IF (0 <> @@ERROR) OR (0 = @@ROWCOUNT) BEGIN    
   ROLLBACK TRAN    
   SET @Ret = 0    
   RETURN @Ret     
  END  
 END  
 ELSE BEGIN
  UPDATE Account SET  Cert = @Cert, Name = @Name, Age = @Age, Sex = @Sex, Email = @Email,     
   Country = @Country, Question = @Question, Answer = @Answer, Status = @Status    
  WHERE UserID = @UserID    
  IF (0 <> @@ERROR) OR (0 = @@ROWCOUNT) BEGIN    
   ROLLBACK TRAN    
   SET @Ret = 0    
   RETURN @Ret     
  END    	
 END
 
 IF (@Password <> '') AND (@Password IS NOT NULL) BEGIN    
  UPDATE  login SET Password = @Password    
  WHERE UserID = @UserID    
  IF (0 <> @@ERROR) OR (0 = @@ROWCOUNT) BEGIN    
   ROLLBACK TRAN    
   SET @Ret = 0    
   RETURN @Ret     
  END    
 END    
  
 COMMIT TRAN    
    
 SET @Ret = 1    
 RETURN @Ret  

GO

-----------------------------------------------------------------------

CREATE TABLE Level (
	Level smallint PRIMARY KEY CLUSTERED
,	MinXP int )
GO

CREATE NONCLUSTERED INDEX IX_Level_MinXP
ON Level( MinXP )
GO

INSERT INTO Level(Level, MinXP) VALUES (1, 0)
GO
INSERT INTO Level(Level, MinXP) VALUES (2, 200)
GO
INSERT INTO Level(Level, MinXP) VALUES (3, 1000)
GO
INSERT INTO Level(Level, MinXP) VALUES (4, 2800)
GO
INSERT INTO Level(Level, MinXP) VALUES (5, 6000)
GO
INSERT INTO Level(Level, MinXP) VALUES (6, 11000)
GO
INSERT INTO Level(Level, MinXP) VALUES (7, 18200)
GO
INSERT INTO Level(Level, MinXP) VALUES (8, 28000)
GO
INSERT INTO Level(Level, MinXP) VALUES (9, 40800)
GO
INSERT INTO Level(Level, MinXP) VALUES (10, 57000)
GO
INSERT INTO Level(Level, MinXP) VALUES (11, 77000)
GO
INSERT INTO Level(Level, MinXP) VALUES (12, 101200)
GO
INSERT INTO Level(Level, MinXP) VALUES (13, 130000)
GO
INSERT INTO Level(Level, MinXP) VALUES (14, 163800)
GO
INSERT INTO Level(Level, MinXP) VALUES (15, 203000)
GO
INSERT INTO Level(Level, MinXP) VALUES (16, 248000)
GO
INSERT INTO Level(Level, MinXP) VALUES (17, 299200)
GO
INSERT INTO Level(Level, MinXP) VALUES (18, 357000)
GO
INSERT INTO Level(Level, MinXP) VALUES (19, 421800)
GO
INSERT INTO Level(Level, MinXP) VALUES (20, 494000)
GO
INSERT INTO Level(Level, MinXP) VALUES (21, 574000)
GO
INSERT INTO Level(Level, MinXP) VALUES (22, 671020)
GO
INSERT INTO Level(Level, MinXP) VALUES (23, 777500)
GO
INSERT INTO Level(Level, MinXP) VALUES (24, 893880)
GO
INSERT INTO Level(Level, MinXP) VALUES (25, 1020600)
GO
INSERT INTO Level(Level, MinXP) VALUES (26, 1158100)
GO
INSERT INTO Level(Level, MinXP) VALUES (27, 1306820)
GO
INSERT INTO Level(Level, MinXP) VALUES (28, 1467200)
GO
INSERT INTO Level(Level, MinXP) VALUES (29, 1639680)
GO
INSERT INTO Level(Level, MinXP) VALUES (30, 1824700)
GO
INSERT INTO Level(Level, MinXP) VALUES (31, 2022700)
GO
INSERT INTO Level(Level, MinXP) VALUES (32, 2253340)
GO
INSERT INTO Level(Level, MinXP) VALUES (33, 2499100)
GO
INSERT INTO Level(Level, MinXP) VALUES (34, 2760460)
GO
INSERT INTO Level(Level, MinXP) VALUES (35, 3037900)
GO
INSERT INTO Level(Level, MinXP) VALUES (36, 3331900)
GO
INSERT INTO Level(Level, MinXP) VALUES (37, 3642940)
GO
INSERT INTO Level(Level, MinXP) VALUES (38, 3971500)
GO
INSERT INTO Level(Level, MinXP) VALUES (39, 4318060)
GO
INSERT INTO Level(Level, MinXP) VALUES (40, 4683100)
GO
INSERT INTO Level(Level, MinXP) VALUES (41, 5067100)
GO
INSERT INTO Level(Level, MinXP) VALUES (42, 5537780)
GO
INSERT INTO Level(Level, MinXP) VALUES (43, 6031700)
GO
INSERT INTO Level(Level, MinXP) VALUES (44, 6549420)
GO
INSERT INTO Level(Level, MinXP) VALUES (45, 7091500)
GO
INSERT INTO Level(Level, MinXP) VALUES (46, 7658500)
GO
INSERT INTO Level(Level, MinXP) VALUES (47, 8335620)
GO
INSERT INTO Level(Level, MinXP) VALUES (48, 9042500)
GO
INSERT INTO Level(Level, MinXP) VALUES (49, 9779780)
GO
INSERT INTO Level(Level, MinXP) VALUES (50, 10548100)
GO
INSERT INTO Level(Level, MinXP) VALUES (51, 11348100)
GO
INSERT INTO Level(Level, MinXP) VALUES (52, 12284460)
GO
INSERT INTO Level(Level, MinXP) VALUES (53, 13257900)
GO
INSERT INTO Level(Level, MinXP) VALUES (54, 14269140)
GO
INSERT INTO Level(Level, MinXP) VALUES (55, 15318900)
GO
INSERT INTO Level(Level, MinXP) VALUES (56, 16407900)
GO
INSERT INTO Level(Level, MinXP) VALUES (57, 17662300)
GO
INSERT INTO Level(Level, MinXP) VALUES (58, 18961900)
GO
INSERT INTO Level(Level, MinXP) VALUES (59, 20307500)
GO
INSERT INTO Level(Level, MinXP) VALUES (60, 21699900)
GO
INSERT INTO Level(Level, MinXP) VALUES (61, 23139900)
GO
INSERT INTO Level(Level, MinXP) VALUES (62, 26116700)
GO
INSERT INTO Level(Level, MinXP) VALUES (63, 29191900)
GO
INSERT INTO Level(Level, MinXP) VALUES (64, 32367100)
GO
INSERT INTO Level(Level, MinXP) VALUES (65, 35643900)
GO
INSERT INTO Level(Level, MinXP) VALUES (66, 39023900)
GO
INSERT INTO Level(Level, MinXP) VALUES (67, 45993500)
GO
INSERT INTO Level(Level, MinXP) VALUES (68, 53175900)
GO
INSERT INTO Level(Level, MinXP) VALUES (69, 60574300)
GO
INSERT INTO Level(Level, MinXP) VALUES (70, 68191900)
GO
INSERT INTO Level(Level, MinXP) VALUES (71, 76031900)
GO
INSERT INTO Level(Level, MinXP) VALUES (72, 88130300)
GO
INSERT INTO Level(Level, MinXP) VALUES (73, 100571900)
GO
INSERT INTO Level(Level, MinXP) VALUES (74, 113361500)
GO
INSERT INTO Level(Level, MinXP) VALUES (75, 126503900)
GO
INSERT INTO Level(Level, MinXP) VALUES (76, 140003900)
GO
INSERT INTO Level(Level, MinXP) VALUES (77, 158487100)
GO
INSERT INTO Level(Level, MinXP) VALUES (78, 177459900)
GO
INSERT INTO Level(Level, MinXP) VALUES (79, 196928700)
GO
INSERT INTO Level(Level, MinXP) VALUES (80, 216899900)
GO
INSERT INTO Level(Level, MinXP) VALUES (81, 237379900)
GO
INSERT INTO Level(Level, MinXP) VALUES (82, 263623900)
GO
INSERT INTO Level(Level, MinXP) VALUES (83, 290519900)
GO
INSERT INTO Level(Level, MinXP) VALUES (84, 318075900)
GO
INSERT INTO Level(Level, MinXP) VALUES (85, 346299900)
GO
INSERT INTO Level(Level, MinXP) VALUES (86, 375199900)
GO
INSERT INTO Level(Level, MinXP) VALUES (87, 404783900)
GO
INSERT INTO Level(Level, MinXP) VALUES (88, 435059900)
GO
INSERT INTO Level(Level, MinXP) VALUES (89, 466035900)
GO
INSERT INTO Level(Level, MinXP) VALUES (90, 497719900)
GO
INSERT INTO Level(Level, MinXP) VALUES (91, 530119900)
GO
INSERT INTO Level(Level, MinXP) VALUES (92, 596367900)
GO
INSERT INTO Level(Level, MinXP) VALUES (93, 664079900)
GO
INSERT INTO Level(Level, MinXP) VALUES (94, 733271900)
GO
INSERT INTO Level(Level, MinXP) VALUES (95, 803959900)
GO
INSERT INTO Level(Level, MinXP) VALUES (96, 876159900)
GO
INSERT INTO Level(Level, MinXP) VALUES (97, 949887900)
GO
INSERT INTO Level(Level, MinXP) VALUES (98, 1025159900)
GO
INSERT INTO Level(Level, MinXP) VALUES (99, 1101991900)
GO
